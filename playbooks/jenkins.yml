- name: Jenkins configuration
  hosts: jenkins
  become: true
  vars:
    jenkins_version: "2.73.1"
    jenkins_hostname: "jenkins"
    jenkins_port: 8080
    jenkins_install_via: "apt"
    jenkins_jobs:
      - "notify-ci"
    jenkins_include_secrets: true
    jenkins_plugins:
      - ssh-credentials
      - credentials
      - scm-api
      - git
      - git-client
      - greenballs
      - ws-cleanup
      - pipeline
  roles:
    - emmetog.jenkins
  tasks:
    - name: Instala o Java 11
      apt:
        name: openjdk-11-jdk
        state: present # estado present quer dizer que é pra instalar o pacote
        update_cache: yes # Roda apt update antes da instalação
    - name: Download golang
      get_url:
        url: https://golang.org/dl/go1.16.4.linux-amd64.tar.gz
        dest: /tmp
    - name: Extract go tar
      shell:
        cmd: rm -rf /usr/local/go && tar -C /usr/local -xzf /tmp/go1.16.4.linux-amd64.tar.gz
    - name: Add golang bin directory to path
      shell:
        cmd: echo 'PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/go/bin"' >> /etc/environment
